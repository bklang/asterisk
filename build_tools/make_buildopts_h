#!/bin/sh

cat << END
/*
 * buildopts.h 
 * Automatically generated
 */

END
TMP=`${GREP} MENUSELECT_CFLAGS menuselect.makeopts | sed 's/MENUSELECT_CFLAGS\=//g' | sed 's/-D//g'`
for x in ${TMP}; do
	echo "#define ${x} 1"
done
TMP=`${GREP} MENUSELECT_BUILD_DEPS menuselect.makeopts | sed 's/MENUSELECT_BUILD_DEPS\=//g'`
for x in ${TMP}; do
	x2=`echo ${x} | tr a-z A-Z`
	echo "#define AST_MODULE_${x2} 1"
done
if ${GREP} AST_DEVMODE makeopts | ${GREP} -q yes
then
	echo "#define AST_DEVMODE 1"
	TMP="${TMP} AST_DEVMODE"
fi

case ${OSARCH} in	# actually we should check build_os
*BSD|mingw*)
	BUILDSUM=`echo ${TMP} | md5`
	echo "#define AST_BUILDOPT_SUM {0x0, 0x0, 0x0, 0x0} /* dummy */"
	;;
*)
	BUILDSUM=`echo ${TMP} | md5sum`
	echo "#define AST_BUILDOPT_SUM { `echo -n ${BUILDSUM} | cut -c1-8`, `echo -n ${BUILDSUM} | cut -c9-16`, `echo -n ${BUILDSUM} | cut -c17-24`, `echo -n ${BUILDSUM} | cut -c25-32` }"
	;;
esac
